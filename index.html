
<html>
	<head>
		<script src="phonegap.js"></script>	
		<script src="jquery-3.1.0.min.js"></script>

	</head>
	<body>
		<h1>Okta SE demo app</h1>
		<p>A window should open now... or now...</p>
		<span id="lnk_linkedin" href="#">Goto LinkedIn</span> <br><br> 
		<span id="lnk_facebook" href="#">Goto Facebook</span> <br><br> 
		<span id="lnk_googleplus" href="#">Goto googleplus</span>
		
		<p id="lbl_token"></p>
	</body>
	<script>
		$( "#lnk_linkedin" ).click(function() {
					openBrowser('https://randomcompany.okta-emea.com/oauth2/v1/authorize?idp=0oacyj8ypAB4J4gr30i6&client_id=QGSed7lDqb73VA6UrrXw&response_type=id_token&scope=openid%20email%20profile&redirect_uri=http://stop/app&state=someState2&nonce=someNonce2', '_blank', 'location=no');
		});
		$( "#lnk_facebook" ).click(function() {
					openBrowser('https://randomcompany.okta-emea.com/oauth2/v1/authorize?idp=0oacy8jkfxWnxwgPn0i6&client_id=eiXCFnbZE1LzT7ahtOwH&response_type=id_token&scope=openid%20email%20profile&redirect_uri=https://randomcompany.okta-emea.com/app/UserHome&state=someState&nonce=someNonce', '_blank', 'location=no');
		});
		$( "#lnk_googleplus" ).click(function() {
					openBrowser('https://randomcompany.okta-emea.com/oauth2/v1/authorize?idp=0oad3gqm0nkUSd9uJ0i6&client_id=VD495qEPPsYluex6tj6G&response_type=id_token&scope=openid%20email%20profile&redirect_uri=https://randomcompany.okta-emea.com/app/UserHome&state=someState3&nonce=someNonce3');
		});




// function to open browser
		function openBrowser(redirurl) {
			//alert("device is ready");
			var ref = window.open(redirurl, '_blank', 'location=yes');
//			alert(redirurl);
			ref.addEventListener('loadstop', function(event) {        
				var baseUrl = event.url.substring(0, 15);
				if (baseUrl.match("http://stop/app")) {
						var url = event.url;
//						alert('This is THE url: '+ url);
						var params = url.substr ( url.indexOf ( '#' ) + 1 );

//						alert('This is THE params: '+ params);
						$('#lbl_token').html(params);
						ref.close();
//						alert('done handling the close event');
				}
			});
		}
		
// When device is ready
		document.addEventListener("deviceready", onDeviceReady, false);
		function onDeviceReady() {
//			openBrowser('http://www.booons.nl/sedemo/');
		}


	</script>
</html>